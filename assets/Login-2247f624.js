import{u as _,a as x,c as v,r as c,o as b,b as y,d as D,e as s,w as m,v as p}from"./index-6b9654e3.js";import{S as A}from"./sweetalert2.all-b80a5553.js";import{s as S,d as U,a as B,_ as q,t as E}from"./firebaseConfig-bb59ec2d.js";const M={class:"w-full grow bg-[#EADFD5] flex justify-center items-center"},T={class:"w-full max-w-md"},N=s("span",{class:"text-[24px] font-medium text-center"},"เข้าสู่ระบบสำหรับเจ้าหน้าที่",-1),P=s("span",null,"Username",-1),V=s("span",null,"Password",-1),j=s("div",{class:"flex justify-center mt-4"},[s("button",{type:"submit",class:"w-[132px] h-[46px] rounded bg-[#3694ED] text-white"},"Login")],-1),z={__name:"Login",setup(k){const o=_(),r=x();v(()=>r.getters.getAuth);const f=e=>r.dispatch("updateAuth",e),n=c(""),u=c(""),l=async(e,t,a)=>{await A.fire({title:e,text:t,icon:a,confirmButtonText:"ตกลง",confirmButtonColor:"#28a745"})};async function h(e,t){try{const a=S(U,"users"),g=B(a,q("username","==",e)),d=await E(g);if(!d.empty){const i=d.docs[0].data();if(i.password===t)return l("เข้าสู่ระบบสำเร็จ","","success"),f({role:"admin",username:e,student:{sNameT:"",slNameT:"",stU_ID:""}}),o.push({name:"Main"}),{authenticated:!0,isAdmin:i.isAdmin}}return l("เข้าสู่ระบบไม่สำเร็จ","กรุณาตรวจสอบ Username และ Password อีกครั้ง","error"),{authenticated:!1,isAdmin:!1}}catch(a){console.error("Error fetching user data:",a),l("เข้าสู่ระบบไม่สำเร็จ","กรุณาตรวจสอบ Username และ Password อีกครั้ง","error")}}const w=e=>{e.preventDefault(),h(n.value,u.value)};return b(()=>{const e=r.getters.getAuth.username,t=r.getters.getAuth.role;e&&(t==="admin"?o.push({name:"Main"}):t==="student"&&o.push({name:"Student"}))}),(e,t)=>(y(),D("div",M,[s("div",T,[s("form",{onSubmit:w,class:"bg-white p-10 rounded-lg flex flex-col gap-4"},[N,s("div",null,[P,m(s("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>n.value=a),type:"text",class:"border-2 border-gray-300 p-2 rounded-lg w-full",required:""},null,512),[[p,n.value]])]),s("div",null,[V,m(s("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>u.value=a),type:"password",class:"border-2 border-gray-300 p-2 rounded-lg w-full",required:""},null,512),[[p,u.value]])]),j],32)])]))}};export{z as default};
